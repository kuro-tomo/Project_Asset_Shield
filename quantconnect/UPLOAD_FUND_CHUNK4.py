# region imports
from AlgorithmImports import *
# endregion


class FundUploader4(QCAlgorithm):
    """Upload fundamental data chunk 4/4 to ObjectStore."""

    def Initialize(self):
        self.SetStartDate(2024, 1, 1)
        self.SetEndDate(2024, 1, 2)
        self.SetCash(1000)

        DATA = {
            "88020": """2008-07-31,1Q,891.95,1.1248680712598718,10.88
2008-10-31,2Q,881.46,1.7065017435517436,16.28
2009-02-05,3Q,837.23,1.022047793865641,9.29
2009-04-30,FY,832.01,3.5633903474742943,32.9
2009-07-31,1Q,855.82,0.73593156256564,6.95
2009-10-30,2Q,858.54,1.516025577604223,14.36
2010-02-04,3Q,859.62,2.654564606261243,25.18
2010-04-30,FY,852.36,0.9110243128656538,8.58
2010-07-30,1Q,837.34,0.529364598204682,4.88
2010-10-29,2Q,847.87,2.2227454236227495,20.68
2011-02-04,3Q,856.38,3.409295736405271,32.02
2011-05-09,FY,866.31,4.8833996047289565,46.27
2011-06-17,FY,866.31,4.8833996047289565,46.27
2012-05-07,FY,905.6,4.113209332455065,40.72
2013-05-07,FY,893.27,3.331378737067271,32.79
2014-05-08,FY,957.8,4.44318367927977,46.34
2015-05-12,FY,1078.11,4.4713848562612375,52.85
2016-05-11,FY,1088.11,5.028146433780542,60.13
2017-05-10,FY,1147.8,5.809523270682222,74.0
2018-05-14,FY,1223.58,6.409651916248733,86.78
2019-05-14,FY,1275.54,6.877914061841342,96.97
2020-05-14,FY,1295.83,7.647359425017232,108.64
2021-05-13,FY,1383.47,6.580571802234061,101.34
2022-05-12,FY,1514.58,6.938328551907682,116.45
2023-05-11,FY,1664.47,6.9473570983482364,125.54
2024-05-10,FY,1896.25,6.417452153533901,131.96
2025-05-12,FY,2057.47,6.908601748421033,151.04""",
            "90200": """2008-07-29,1Q,413965.45,3.7940700359463895,15953.21
2008-10-29,2Q,425147.67,7.072476131639068,30538.43
2009-01-30,3Q,427214.04,9.644504955547982,41852.24
2009-04-27,FY,4301.06,10.734817212756763,468.68
2009-07-27,1Q,4354.84,2.1571869828886534,94.69
2009-10-28,2Q,4479.87,5.252733402022668,238.09
2010-01-29,3Q,4503.92,7.06752681326297,322.52
2010-04-27,FY,4501.3,6.6506707709398425,303.35
2010-07-27,1Q,4543.98,2.474374140023505,114.06
2010-10-28,2Q,4667.95,5.1867727257680265,245.58
2011-01-28,3Q,4727.85,7.254827441341442,347.94
2011-04-27,FY,4574.05,4.154904050301027,192.69
2012-04-26,FY,4738.51,5.751354176088115,274.89
2013-04-30,FY,5135.76,8.56286910602131,443.7
2014-04-30,FY,5529.4,9.090793354603187,506.77
2015-04-28,FY,5818.19,7.826415546192238,458.95
2016-04-27,FY,6232.4,9.961637124640157,625.82
2017-04-28,FY,6825.51,10.388348752482383,713.96
2018-04-27,FY,7426.92,10.01739611558398,749.2
2019-04-25,FY,8046.93,9.54039874895698,773.26
2020-04-28,FY,8340.01,6.2527986306286545,524.91
2021-04-28,FY,6719.93,-22.597513608755275,-1531.91
2022-04-27,FY,6348.57,-3.92653766784803,-251.69
2023-04-27,FY,6566.64,3.9729144221133494,263.38
2024-04-30,FY,2402.34,7.17168169764372,173.82
2025-04-30,FY,2527.69,7.808779005478697,198.29""",
            "90220": """2008-07-29,1Q,490261.48,5.656566891026913,28193.44
2008-10-28,2Q,511542.12,10.025710706219296,52117.3
2009-01-30,3Q,517233.88,12.646017884044369,67610.65
2009-04-28,FY,513233.3,12.02375524391477,64023.29
2009-07-29,1Q,528492.57,2.8567137918919645,15643.37
2009-10-28,2Q,547161.9,6.245161012817939,35376.6
2010-01-29,3Q,559155.06,8.907605339247116,51543.43
2010-04-28,FY,555999.83,8.088026611056563,46574.56
2010-07-27,1Q,572160.2,3.998573595184595,23643.64
2010-10-27,2Q,592434.8,7.3245593638097,44815.57
2011-01-28,3Q,612183.85,10.660573975858664,67367.94
2011-04-27,FY,613134.62,10.737597439802785,67990.31
2012-04-26,FY,671574.47,9.740025864642682,67470.45
2012-05-23,FY,671574.47,9.740025864642682,67470.45
2013-04-30,FY,7689.65,12.83533978787809,1016.12
2014-04-25,FY,8911.47,14.18702822912667,1299.23
2015-04-28,FY,10265.27,12.79739453198622,1342.15
2016-04-27,FY,11770.36,14.343487069013156,1714.64
2017-04-27,FY,13681.22,14.409682810429638,1996.52
2018-04-26,FY,15602.66,12.821246789436644,2015.48
2019-04-25,FY,17703.74,12.505897125623386,2238.95
2020-04-27,FY,19514.81,10.275578929589424,2027.86
2021-04-27,FY,18510.87,-5.467192208341053,-1025.46
2022-04-26,FY,18110.23,-1.438746865001391,-263.87
2023-04-26,FY,19101.99,5.763348051409074,1114.93
2024-04-30,FY,4237.48,9.10132223464687,390.66
2025-04-30,FY,4675.36,9.84046538085885,465.88""",
            "91010": """2008-07-25,1Q,583.41,5.863574957899218,36.12
2008-10-27,2Q,570.23,12.313690572554098,74.33
2009-01-30,3Q,471.91,17.799101456621795,89.79
2009-04-27,FY,443.16,9.66060316187717,45.73
2009-07-27,1Q,454.22,-3.1583674450595316,-15.41
2009-10-27,2Q,426.39,-5.19037076855611,-23.91
2010-01-29,3Q,380.28,-3.8828804834280075,-20.93
2010-07-29,1Q,378.15,3.3617991195636123,13.54
2010-10-29,2Q,383.18,6.406400914746388,26.14
2011-01-31,3Q,388.74,10.148071340874584,41.98
2011-04-28,FY,403.46,10.786381978151173,46.27
2011-07-29,1Q,386.96,-1.0246292148998941,-4.21
2011-10-31,2Q,361.87,-1.8435877136944807,-7.11
2012-01-31,3Q,355.41,-2.6813084474797253,-10.18
2012-04-27,FY,341.54,-11.698179890440006,-42.92
2012-07-31,1Q,321.67,-0.22606898333548636,-0.78
2012-10-31,2Q,321.73,-0.7052212548824971,-2.45
2013-01-31,3Q,346.72,0.5010029535798335,1.87
2013-04-30,FY,383.83,2.70444725283061,11.14
2013-07-31,1Q,401.47,1.1721743032903522,5.05
2013-10-31,2Q,416.92,2.7044136304768136,12.09
2014-01-31,3Q,431.06,3.615955811070927,16.73
2014-07-31,1Q,426.52,1.3164384814208572,6.03
2014-10-31,2Q,440.13,2.4933434386748705,11.79
2015-01-30,3Q,452.21,3.4445860674440194,16.78
2015-04-30,FY,477.79,5.402401799022162,28.06
2015-07-31,1Q,506.95,4.6190790800238535,25.39
2015-10-30,2Q,495.94,5.998902479498164,32.29
2016-01-29,3Q,473.84,2.605099474802266,13.46
2016-04-28,FY,456.21,2.16021197035542,10.75
2016-06-21,FY,456.21,2.16021197035542,10.75
2016-07-29,1Q,428.94,-1.614081943562668,-7.54
2016-10-31,2Q,296.03,-41.139932419002186,-136.91
2017-01-31,3Q,310.13,-38.13727143917415,-133.69
2017-04-28,FY,309.8,-44.89404259919991,-157.23
2018-04-27,FY,3272.21,3.428275152782382,119.57
2019-04-26,FY,2889.26,-8.529589343044709,-263.8
2020-05-25,FY,2740.41,6.240289953271497,184.39
2021-05-10,FY,3703.27,20.860908795330012,824.55
2022-05-09,FY,10144.29,57.365726152354114,5973.76
2023-05-09,FY,4877.55,40.10003196048464,1993.71
2024-05-08,FY,5772.5,8.487635355772426,468.13
2025-05-08,FY,6735.03,16.084556997656207,1070.32""",
            "94320": """2008-08-06,1Q,549545.11,2.3419659310626755,12870.16
2008-11-07,2Q,566770.15,5.331336824643281,29938.86
2009-02-05,3Q,571266.76,7.162884016501084,40236.28
2009-05-13,FY,5515.18,7.381075374309239,400.41
2010-05-14,FY,5885.86,5.038093297440281,372.01
2010-08-05,1Q,5934.46,1.5836823982422261,117.85
2010-11-09,2Q,6037.73,3.141381186889938,238.24
2011-02-04,3Q,6083.26,4.536255482592879,346.39
2011-05-13,FY,6061.92,5.055375832313917,385.16
2011-08-05,1Q,6128.98,1.5025060745141714,115.69
2011-11-09,2Q,6324.22,2.9268047536671573,228.66
2012-02-06,3Q,6267.45,3.570558439514869,279.29
2012-05-11,FY,6441.26,5.933343964360939,366.67
2012-08-06,1Q,6536.22,1.9572923705478504,127.93
2012-11-08,2Q,6632.16,3.6211069382613084,239.78
2013-02-06,3Q,6805.89,5.490224764567979,367.16
2013-05-10,FY,7018.06,6.299661715530913,432.44
2013-08-05,1Q,7083.69,2.0199084264240086,141.29
2013-11-08,2Q,7279.12,3.8927532873455677,277.46
2014-02-06,3Q,7443.36,4.466885781760813,418.78
2014-05-13,FY,7667.57,5.3591157591265235,509.21
2014-08-06,1Q,7689.53,1.3614602157772553,134.22
2014-11-07,2Q,7828.58,2.610657935579337,261.63
2015-02-06,3Q,8014.2,4.090380536181024,407.69
2015-05-15,FY,8201.27,4.688460706564186,473.69
2015-08-05,1Q,4131.77,1.7377564156193241,91.24
2015-11-06,2Q,4204.33,3.3557283346971687,178.37
2016-02-05,3Q,4247.84,5.3232768135844095,286.43
2016-05-13,FY,4214.32,6.5634574552036185,350.34
2016-08-05,1Q,4215.32,2.225175995667799,116.73
2016-11-11,2Q,4298.9,4.27513763436805,230.9
2017-02-10,3Q,4365.38,5.92921135481107,325.64
2017-05-15,FY,4491.73,6.952954164130695,390.94
2017-08-04,1Q,4566.41,2.3327559417512203,135.24
2017-11-10,2Q,4705.67,4.395364038930475,262.84
2018-02-09,3Q,4736.86,6.141405658941086,367.98
2018-05-11,FY,4812.59,7.560283766925235,455.78
2019-02-07,3Q,4812.32,6.7527688520164215,406.5
2019-05-10,FY,4832.03,7.239103787530316,440.25
2019-08-06,1Q,4854.16,2.4095510056416116,147.31
2019-11-05,2Q,4971.65,4.739290559347397,291.05
2020-02-06,3Q,2516.5,6.849768499000068,214.2
2020-05-15,FY,2492.6,7.461692681791006,231.21
2020-08-11,1Q,2534.52,2.3034305348046646,73.51
2020-11-06,2Q,2618.26,4.426888941300155,145.86
2021-02-05,3Q,2025.28,10.329797040231666,224.07
2021-05-12,FY,2087.98,11.168794312062,248.15
2021-08-06,1Q,2135.59,4.055711865486457,93.87
2021-11-10,2Q,2230.17,7.768721353664058,186.77
2022-02-07,3Q,2258.31,11.841748678595605,286.08
2022-05-12,FY,2338.73,13.096758840966178,329.29
2022-08-08,1Q,2404.21,3.9654852052015133,104.07
2022-11-08,2Q,2456.26,7.494780281200986,197.04
2023-02-09,3Q,2447.28,11.221447325621368,294.5
2023-05-12,FY,2511.06,12.973632677252553,347.99
2023-08-09,FY,2511.06,12.973632677252553,347.99
2023-08-09,1Q,104.97,3.83938845241917,4.41
2023-11-07,2Q,109.48,6.5639240532958025,7.87
2024-02-08,3Q,109.78,9.990618186884333,11.89
2024-08-07,1Q,118.55,2.4767047763497714,3.26
2024-11-07,2Q,119.16,5.018293335957694,6.6
2025-02-07,3Q,122.21,7.541386979192661,10.15
2025-05-09,FY,123.54,8.814877229676501,11.96
2025-08-06,1Q,113.67,2.577199690554244,3.14
2025-11-04,2Q,111.57,6.243611223617865,7.2""",
            "94330": """2008-07-22,1Q,387571.05,4.096312386009387,16244.12
2008-10-22,2Q,404920.22,8.183451143361076,33886.68
2009-01-23,3Q,422091.07,13.210819967576725,56957.48
2009-04-23,FY,413339.32,11.8392902038931,49973.11
2009-07-23,1Q,428683.48,4.430028041072225,19401.68
2009-10-23,2Q,442415.75,7.215523616124926,32619.78
2010-01-25,3Q,451523.47,10.283301585643564,47741.41
2010-04-23,FY,453003.09,10.236666746854626,47768.01
2010-07-23,1Q,461831.0,3.3934091775532313,16147.14
2010-10-22,2Q,475513.51,6.277172829622148,30752.37
2011-01-24,3Q,482831.85,9.528473603803848,45715.52
2011-04-25,FY,495386.23,11.746819170297613,58149.78
2012-04-25,FY,539206.73,11.209307045302506,58115.98
2013-04-30,FY,2943.12,10.39308106395772,315.9
2014-04-30,FY,3261.63,11.040082770281273,398.6
2015-05-12,FY,1201.86,13.212852620827553,170.84
2016-05-12,FY,1328.89,14.089497580538076,197.56
2017-05-11,FY,1446.15,14.20210733170301,221.65
2018-05-10,FY,1568.84,13.858445504600658,235.54
2019-05-15,FY,1779.41,13.389943749441787,259.1
2020-05-14,FY,1906.35,13.166346580483495,275.69
2021-05-14,FY,2091.82,12.387105998723445,284.16
2022-05-13,FY,2249.27,12.203359196524993,300.03
2023-05-11,FY,2374.65,11.959317043203797,310.25
2024-05-10,FY,2522.92,11.003090098609231,301.26
2025-05-14,FY,1288.96,12.134647607357273,169.33""",
            "97350": """2008-08-05,1Q,2471.05,2.191951365422238,60.26
2008-11-05,2Q,2471.45,2.092542139118442,57.6
2009-02-05,3Q,2382.39,2.0234061471174876,52.67
2009-05-11,FY,2380.12,3.6906461977865046,96.69
2009-08-05,1Q,2396.63,2.09509506092774,56.31
2009-11-05,2Q,2468.51,4.339391887743334,119.94
2010-02-08,3Q,2516.9,6.5032040263360695,183.07
2010-05-11,FY,2561.94,7.615895628750081,218.37
2010-08-05,1Q,2534.84,2.129834008457241,60.41
2010-11-09,2Q,2580.27,4.564299521823177,131.69
2011-02-08,3Q,2661.58,7.3861432948261765,219.26
2011-05-11,FY,2716.35,9.302887371857107,279.07
2012-05-10,FY,2785.56,5.284899712144294,162.63
2012-08-09,1Q,2771.33,2.2857596054277627,69.98
2012-11-08,2Q,2835.5,4.6382208233635405,145.29
2013-02-07,3Q,2924.72,6.724018342528228,221.62
2013-05-09,FY,3065.13,8.330683291914168,291.65
2013-08-07,1Q,3067.76,2.485567315762201,87.25
2013-11-06,2Q,3168.49,4.4850340695563045,162.39
2014-02-12,3Q,3258.55,6.517949643578605,241.55
2014-05-08,FY,3345.06,8.415054030196215,320.14
2014-08-06,1Q,3324.88,2.772012076523355,105.0
2014-11-10,2Q,3424.85,4.840785744596566,188.68
2015-02-12,3Q,3500.72,6.879276426109235,273.48
2015-05-11,FY,3667.33,8.309114213950433,345.42
2015-08-05,1Q,3708.65,2.2393207168271014,94.01
2015-11-09,2Q,3785.08,4.283336649188899,183.47
2016-02-10,3Q,3799.59,6.581849927604122,283.25
2016-05-11,FY,3817.82,8.16831788146879,352.97
2016-08-05,1Q,3792.95,2.1349610658509546,91.84
2016-11-09,2Q,3844.39,4.294074246905328,187.2
2017-02-09,3Q,3922.87,6.797357635293561,302.58
2017-05-11,FY,4086.87,8.30690854110474,385.64
2017-08-08,1Q,4100.47,2.03173393711248,94.31
2017-11-09,2Q,4196.52,3.9885347233678816,189.42
2018-02-08,3Q,4244.57,6.010584953442015,289.15
2018-05-10,FY,4364.63,8.045870702627512,398.58
2018-08-10,1Q,4381.77,2.5195156562666043,125.36
2018-11-08,2Q,4461.21,4.029047102114086,204.23
2019-02-08,3Q,4484.81,6.263907301778422,318.44
2019-05-14,FY,4562.08,8.171648220087144,421.56
2019-08-08,1Q,4558.06,1.8130288963418697,93.5
2019-11-08,2Q,4642.74,3.78050938545801,198.7
2020-02-06,3Q,4682.27,5.853895159501424,310.74
2020-05-12,FY,4742.58,7.597480242969261,408.14
2020-08-12,1Q,4750.41,1.630607875764507,87.73
2020-11-09,2Q,4811.53,2.7167639278227353,148.27
2021-02-05,3Q,4824.11,4.526906572033488,248.05
2021-05-13,FY,4958.18,6.072494926103247,342.17
2021-08-06,1Q,4958.53,1.9426149416410736,109.49
2021-11-10,2Q,5026.34,3.898494451833339,219.98
2022-02-10,3Q,5039.35,5.94127311491525,335.78
2022-05-12,FY,5147.3,7.505596973335159,431.27
2022-08-09,1Q,5160.21,1.8474176128329873,106.51
2022-11-10,2Q,5311.07,3.409478058755738,203.19
2023-02-09,3Q,5355.14,5.535288793660762,332.79
2023-05-11,FY,5427.63,7.30103104220442,445.02
2023-08-09,1Q,5474.66,2.0314968872530983,125.59
2023-11-09,2Q,5618.9,3.6624029655181136,231.36
2024-02-08,3Q,5629.62,5.70015962776418,360.21
2024-05-10,FY,5816.74,7.330970475785743,482.04
2024-08-09,1Q,5844.98,1.7820907541933568,117.71
2024-11-08,2Q,2974.61,3.590502802843861,120.97
2025-02-12,3Q,2964.75,5.675417146196374,190.92
2025-05-12,FY,3056.12,7.467452629484933,259.97
2025-08-08,1Q,3029.57,1.750789606884937,60.24
2025-11-11,2Q,3084.0,3.423297554010603,119.39""",
            "99840": """2008-08-05,1Q,367.39,2.292988201197639,17.92
2008-10-29,2Q,382.96,4.767078116775152,38.04
2009-02-05,3Q,359.16,6.896077620283111,53.84
2009-04-30,FY,346.11,5.234251295468709,39.95
2009-07-30,1Q,380.33,3.150643636581201,25.33
2009-10-29,2Q,409.46,7.754877900406541,65.41
2010-02-02,3Q,428.84,10.052114461074165,87.68
2010-04-27,FY,434.74,10.0330819080657,89.39
2010-07-29,1Q,434.83,1.9564602543056118,17.96
2010-10-28,2Q,476.86,7.350566509908663,70.99
2011-02-03,3Q,527.23,17.463385539773356,131.47
2011-05-09,FY,572.14,21.56754409300401,175.28
2012-04-26,FY,852.69,21.854503914630406,285.78
2013-04-30,FY,1316.9,13.738838496263158,258.35
2014-05-07,FY,1645.31,18.436370759828872,442.64
2015-05-11,FY,2393.47,17.345712382275718,562.2
2016-05-10,FY,2278.85,13.527399165428294,402.49
2017-05-10,FY,3292.4,31.910383848688845,1287.01
2018-05-09,FY,4302.26,16.562623246020816,933.54
2019-05-09,FY,6760.66,15.663969869036155,1268.15
2020-05-18,FY,2619.32,-13.042002236021375,-478.5
2021-05-12,FY,5588.8,41.7207410790916,2619.61
2022-05-12,FY,5755.92,-14.588859937535457,-1018.58
2023-05-11,FY,5888.94,-9.110004821951664,-652.37
2024-05-13,FY,7479.43,-1.7197483842655479,-170.99
2025-05-13,FY,7905.39,8.26581990171881,780.82""",
        }

        uploaded = 0
        for code, csv_data in DATA.items():
            if csv_data.strip():
                key = f"japan_fundamentals/{code}.csv"
                self.ObjectStore.Save(key, csv_data.strip())
                lines = len(csv_data.strip().split('\n'))
                self.Debug(f"Uploaded: {key} ({lines} records)")
                uploaded += 1

        self.Debug(f"Chunk complete: {uploaded} stocks uploaded")

    def OnData(self, data):
        pass
