/Users/MBP/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
INFO:__main__:Extended database schema initialized
INFO:shield.jquants_client:J-Quants v2 API initialized with x-api-key authentication
INFO:__main__:
======================================================================
INFO:__main__:ASSET SHIELD - TEST INGESTION
INFO:__main__:Period: 2024 to 2026 (3 years)
INFO:__main__:Stocks: 3
INFO:__main__:======================================================================
INFO:__main__:Verifying J-Quants credentials...
INFO:__main__:  Credentials verified. Test fetch: トヨタ自動車
INFO:__main__:  Plan: premium
INFO:__main__:  Rate limit: 600 req/min
INFO:__main__:
============================================================
INFO:__main__:Ingesting daily quotes: 2024-01-01 to 2026-12-31
INFO:__main__:Stocks: 3
INFO:__main__:============================================================
INFO:__main__:
[1/3] Processing 72030...
INFO:shield.jquants_backtest_provider:Cache hit for 72030: 508 quotes
INFO:__main__:  Fetched 508 records
INFO:__main__:  Valid: 508, Invalid: 0
INFO:__main__:
[2/3] Processing 67580...
INFO:shield.jquants_backtest_provider:Cache hit for 67580: 508 quotes
INFO:__main__:  Fetched 508 records
INFO:__main__:  Valid: 508, Invalid: 0
WARNING:__main__:    1 price anomalies detected
INFO:__main__:
[3/3] Processing 99840...
INFO:shield.jquants_backtest_provider:Fetched 508 quotes for 99840
INFO:__main__:  Fetched 508 records
INFO:__main__:  Valid: 508, Invalid: 0
WARNING:__main__:    1 price anomalies detected
INFO:__main__:
======================================================================
INFO:__main__:DATA INTEGRITY REPORT
INFO:__main__:======================================================================
INFO:__main__:
67580: [OK]
INFO:__main__:  Records: 508 valid, 0 invalid
INFO:__main__:  Missing dates: 276 (may be holidays)
INFO:__main__:  Price anomalies: 1
INFO:__main__:    - 2024-09-27: 79.9% change
INFO:__main__:
72030: [OK]
INFO:__main__:  Records: 508 valid, 0 invalid
INFO:__main__:  Missing dates: 276 (may be holidays)
INFO:__main__:
99840: [OK]
INFO:__main__:  Records: 508 valid, 0 invalid
INFO:__main__:  Missing dates: 276 (may be holidays)
INFO:__main__:  Price anomalies: 1
INFO:__main__:    - 2025-12-29: 74.8% change
INFO:__main__:
======================================================================
INFO:__main__:TEST INGESTION COMPLETE
INFO:__main__:======================================================================
INFO:__main__:Duration: 0:00:01.009963
INFO:__main__:Total records: 1,524
INFO:__main__:Valid stocks: 3 / 3
INFO:__main__:Cache size: 271.85 MB
INFO:__main__:
Report saved to: /Users/MBP/Desktop/Project_Asset_Shield/output/ingestion_report_INGEST_20260203_080218.json
