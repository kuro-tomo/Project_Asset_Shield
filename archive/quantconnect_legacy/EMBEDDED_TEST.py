from AlgorithmImports import *
from datetime import datetime
class AssetShieldJP(QCAlgorithm):
    def Initialize(self):
        self.SetStartDate(2024, 6, 1)
        self.SetEndDate(2025, 12, 31)
        self.SetCash(10000000)
        self.data = {
            "72030": {
                "2025-06-23": (2493.5, 18469900),
                "2025-06-24": (2490.0, 20203700),
                "2025-06-25": (2460.5, 22587200),
                "2025-06-26": (2456.5, 27545800),
                "2025-06-27": (2527.0, 33017800),
                "2025-06-30": (2493.0, 29284500),
                "2025-07-01": (2453.0, 24298200),
                "2025-07-02": (2465.5, 24281200),
                "2025-07-03": (2511.5, 34098600),
                "2025-07-04": (2484.5, 19876900),
                "2025-07-07": (2453.5, 20788700),
                "2025-07-08": (2465.0, 32336400),
                "2025-07-09": (2487.5, 31320400),
                "2025-07-10": (2473.5, 26257000),
                "2025-07-11": (2508.0, 25922800),
                "2025-07-14": (2531.5, 16698800),
                "2025-07-15": (2532.0, 21037000),
                "2025-07-16": (2509.5, 17977300),
                "2025-07-17": (2520.5, 16570200),
                "2025-07-18": (2516.0, 12975500),
                "2025-07-22": (2496.5, 22144000),
                "2025-07-23": (2854.5, 184109600),
                "2025-07-24": (2844.5, 76238500),
                "2025-07-25": (2787.0, 36978000),
                "2025-07-28": (2805.0, 28105100),
                "2025-07-29": (2741.5, 24229100),
                "2025-07-30": (2743.5, 22891900),
                "2025-07-31": (2696.5, 31733900),
                "2025-08-01": (2724.5, 28121900),
                "2025-08-04": (2675.0, 24277700),
                "2025-08-05": (2679.0, 19623500),
                "2025-08-06": (2721.0, 24559800),
                "2025-08-07": (2680.0, 55966800),
                "2025-08-08": (2773.0, 52683900),
                "2025-08-12": (2855.0, 41157800),
                "2025-08-13": (2875.0, 35352300),
                "2025-08-14": (2805.0, 21262700),
                "2025-08-15": (2854.0, 20036900),
                "2025-08-18": (2903.0, 22691000),
                "2025-08-19": (2925.0, 28833900),
                "2025-08-20": (2937.0, 22852700),
                "2025-08-21": (2904.0, 15393500),
                "2025-08-22": (2943.0, 17269600),
                "2025-08-25": (2940.0, 19219100),
                "2025-08-26": (2898.5, 24050800),
                "2025-08-27": (2904.5, 15271700),
                "2025-08-28": (2919.0, 21577200),
                "2025-08-29": (2873.0, 22056600),
                "2025-09-01": (2858.5, 14369100),
                "2025-09-02": (2869.0, 16428500),
                "2025-09-03": (2851.5, 22723600),
                "2025-09-04": (2905.0, 20172300),
                "2025-09-05": (2962.5, 39740400),
                "2025-09-08": (2970.0, 20701300),
                "2025-09-09": (2949.0, 20893100),
                "2025-09-10": (2913.5, 21880400),
                "2025-09-11": (2886.5, 23863900),
                "2025-09-12": (2889.0, 22253600),
                "2025-09-16": (2934.5, 22117100),
                "2025-09-17": (2950.5, 18883400),
                "2025-09-18": (2940.5, 20542800),
                "2025-09-19": (2923.0, 39502900),
                "2025-09-22": (2964.0, 18457400),
                "2025-09-24": (2929.5, 21777500),
                "2025-09-25": (2961.5, 19580500),
                "2025-09-26": (2969.5, 32053900),
                "2025-09-29": (2870.0, 24786300),
                "2025-09-30": (2849.5, 22116900),
                "2025-10-01": (2821.5, 26571700),
                "2025-10-02": (2805.0, 22099300),
                "2025-10-03": (2839.5, 14005700),
                "2025-10-06": (2974.0, 45597700),
                "2025-10-07": (3023.0, 31197700),
                "2025-10-08": (3009.0, 31036900),
                "2025-10-09": (2947.5, 28589800),
                "2025-10-10": (2898.5, 25255700),
                "2025-10-14": (2871.5, 24550500),
                "2025-10-15": (2913.5, 18470700),
                "2025-10-16": (2954.5, 19598500),
                "2025-10-17": (2933.5, 14316900),
                "2025-10-20": (3003.0, 20574600),
                "2025-10-21": (3005.0, 16336700),
                "2025-10-22": (3104.0, 49951100),
                "2025-10-23": (3091.0, 18085400),
                "2025-10-24": (3127.0, 18839800),
                "2025-10-27": (3218.0, 24626500),
                "2025-10-28": (3171.0, 19805700),
                "2025-10-29": (3146.0, 20640200),
                "2025-10-30": (3185.0, 23926200),
                "2025-10-31": (3138.0, 25906600),
                "2025-11-04": (3155.0, 26958800),
                "2025-11-05": (3040.0, 56932600),
                "2025-11-06": (3139.0, 32756900),
                "2025-11-07": (3118.0, 17774800),
                "2025-11-10": (3131.0, 19709600),
                "2025-11-11": (3147.0, 17570500),
                "2025-11-12": (3190.0, 20882100),
                "2025-11-13": (3198.0, 16407400),
                "2025-11-14": (3180.0, 17302600),
                "2025-11-17": (3119.0, 15668000),
                "2025-11-18": (3029.0, 21663600),
                "2025-11-19": (3037.0, 15126800),
                "2025-11-20": (3044.0, 17872000),
                "2025-11-21": (3097.0, 31305500),
                "2025-11-25": (3077.0, 17998000),
                "2025-11-26": (3141.0, 20618800),
                "2025-11-27": (3138.0, 11108400),
                "2025-11-28": (3133.0, 13070100),
                "2025-12-01": (3082.0, 13231700),
                "2025-12-02": (3045.0, 17880100),
                "2025-12-03": (3005.0, 16544800),
                "2025-12-04": (3103.0, 21589300),
                "2025-12-05": (3032.0, 21707900),
                "2025-12-08": (3060.0, 15596600),
                "2025-12-09": (3066.0, 15163400),
                "2025-12-10": (3116.0, 20327700),
                "2025-12-11": (3110.0, 14242200),
                "2025-12-12": (3260.0, 42664200),
                "2025-12-15": (3350.0, 31427000),
                "2025-12-16": (3330.0, 28736000),
                "2025-12-17": (3349.0, 20872500),
                "2025-12-18": (3363.0, 19193200),
                "2025-12-19": (3424.0, 37972600),
                "2025-12-22": (3455.0, 17099900),
                "2025-12-23": (3415.0, 17000600),
                "2025-12-24": (3353.0, 12845800),
                "2025-12-25": (3374.0, 7132300),
                "2025-12-26": (3380.0, 10705500),
                "2025-12-29": (3364.0, 12099700),
                "2025-12-30": (3356.0, 12175900),
                "2026-01-05": (3399.0, 18505900),
                "2026-01-06": (3429.0, 21996200),
                "2026-01-07": (3335.0, 21592100),
                "2026-01-08": (3294.0, 18107700),
                "2026-01-09": (3388.0, 24104300),
                "2026-01-13": (3641.0, 50179500),
                "2026-01-14": (3622.0, 26474500),
                "2026-01-15": (3714.0, 35684100),
                "2026-01-16": (3670.0, 20254500),
                "2026-01-19": (3623.0, 17580700),
                "2026-01-20": (3541.0, 20386000),
                "2026-01-21": (3552.0, 16952900),
                "2026-01-22": (3584.0, 17423300),
                "2026-01-23": (3624.0, 21187900),
                "2026-01-26": (3477.0, 28379900),
                "2026-01-27": (3459.0, 18214200),
                "2026-01-28": (3347.0, 23115000),
                "2026-01-29": (3448.0, 24456700),
                "2026-01-30": (3504.0, 23842000),
                "2026-02-02": (3535.0, 22997000),
            },
            "67580": {
                "2025-06-23": (3530.0, 19880500),
                "2025-06-24": (3584.0, 11306900),
                "2025-06-25": (3629.0, 10768300),
                "2025-06-26": (3673.0, 12238700),
                "2025-06-27": (3790.0, 17659200),
                "2025-06-30": (3730.0, 15477800),
                "2025-07-01": (3640.0, 13500100),
                "2025-07-02": (3676.0, 14327100),
                "2025-07-03": (3657.0, 11266300),
                "2025-07-04": (3688.0, 7796500),
                "2025-07-07": (3683.0, 7879600),
                "2025-07-08": (3671.0, 14722500),
                "2025-07-09": (3671.0, 10025000),
                "2025-07-10": (3607.0, 18484100),
                "2025-07-11": (3600.0, 12368000),
                "2025-07-14": (3589.0, 6488700),
                "2025-07-15": (3566.0, 8062100),
                "2025-07-16": (3540.0, 12242100),
                "2025-07-17": (3633.0, 9757300),
                "2025-07-18": (3565.0, 9130700),
                "2025-07-22": (3539.0, 11235300),
                "2025-07-23": (3692.0, 20639900),
                "2025-07-24": (3787.0, 16384400),
                "2025-07-25": (3706.0, 9921000),
                "2025-07-28": (3638.0, 9954400),
                "2025-07-29": (3605.0, 8436100),
                "2025-07-30": (3642.0, 10099200),
                "2025-07-31": (3682.0, 12172600),
                "2025-08-01": (3680.0, 12274300),
                "2025-08-04": (3617.0, 9324000),
                "2025-08-05": (3628.0, 9201200),
                "2025-08-06": (3707.0, 11220300),
                "2025-08-07": (3860.0, 33559300),
                "2025-08-08": (3995.0, 34056600),
                "2025-08-12": (3992.0, 21378800),
                "2025-08-13": (4130.0, 19538500),
                "2025-08-14": (4070.0, 14848500),
                "2025-08-15": (4292.0, 17329500),
                "2025-08-18": (4183.0, 16463300),
                "2025-08-19": (4168.0, 9659400),
                "2025-08-20": (4128.0, 10492100),
                "2025-08-21": (4094.0, 9124100),
                "2025-08-22": (4221.0, 11847200),
                "2025-08-25": (4174.0, 8081900),
                "2025-08-26": (4096.0, 13435900),
                "2025-08-27": (4097.0, 8899900),
                "2025-08-28": (4143.0, 13136800),
                "2025-08-29": (4083.0, 11325300),
                "2025-09-01": (4021.0, 7676500),
                "2025-09-02": (4014.0, 8262500),
                "2025-09-03": (3990.0, 10706000),
                "2025-09-04": (4105.0, 10152900),
                "2025-09-05": (4092.0, 11283900),
                "2025-09-08": (4184.0, 12784700),
                "2025-09-09": (4217.0, 11371800),
                "2025-09-10": (4276.0, 11069400),
                "2025-09-11": (4255.0, 10522700),
                "2025-09-12": (4286.0, 15107400),
                "2025-09-16": (4221.0, 15476700),
                "2025-09-17": (4267.0, 11898000),
                "2025-09-18": (4433.0, 16890600),
                "2025-09-19": (4321.0, 22209700),
                "2025-09-22": (4390.0, 12485200),
                "2025-09-24": (4322.0, 20093500),
                "2025-09-25": (4460.0, 20506500),
                "2025-09-26": (4405.0, 22037900),
                "2025-09-29": (4268.0, 19566400),
                "2025-09-30": (4259.0, 16105800),
                "2025-10-01": (4215.0, 14775100),
                "2025-10-02": (4112.0, 15185300),
                "2025-10-03": (4206.0, 9277300),
                "2025-10-06": (4492.0, 21132700),
                "2025-10-07": (4497.0, 14524300),
                "2025-10-08": (4545.0, 15576000),
                "2025-10-09": (4648.0, 13895100),
                "2025-10-10": (4461.0, 19035600),
                "2025-10-14": (4310.0, 19053400),
                "2025-10-15": (4342.0, 11537300),
                "2025-10-16": (4321.0, 10508900),
                "2025-10-17": (4300.0, 11461600),
                "2025-10-20": (4420.0, 9863400),
                "2025-10-21": (4418.0, 11129800),
                "2025-10-22": (4400.0, 8117500),
                "2025-10-23": (4389.0, 10770500),
                "2025-10-24": (4377.0, 7675900),
                "2025-10-27": (4402.0, 10964500),
                "2025-10-28": (4375.0, 8515800),
                "2025-10-29": (4315.0, 9830300),
                "2025-10-30": (4232.0, 20628100),
                "2025-10-31": (4332.0, 16334500),
                "2025-11-04": (4295.0, 14034600),
                "2025-11-05": (4244.0, 15647000),
                "2025-11-06": (4350.0, 13588900),
                "2025-11-07": (4259.0, 13062400),
                "2025-11-10": (4284.0, 10442600),
                "2025-11-11": (4520.0, 30172000),
                "2025-11-12": (4686.0, 21405000),
                "2025-11-13": (4669.0, 13979200),
                "2025-11-14": (4700.0, 13383800),
                "2025-11-17": (4548.0, 15228300),
                "2025-11-18": (4409.0, 12530700),
                "2025-11-19": (4332.0, 13170800),
                "2025-11-20": (4461.0, 13478300),
                "2025-11-21": (4507.0, 24795200),
                "2025-11-25": (4388.0, 20718200),
                "2025-11-26": (4525.0, 11471500),
                "2025-11-27": (4583.0, 9027700),
                "2025-11-28": (4575.0, 9647000),
                "2025-12-01": (4414.0, 9494800),
                "2025-12-02": (4442.0, 9620200),
                "2025-12-03": (4388.0, 11108400),
                "2025-12-04": (4418.0, 9023800),
                "2025-12-05": (4332.0, 11284700),
                "2025-12-08": (4300.0, 8999000),
                "2025-12-09": (4306.0, 10206500),
                "2025-12-10": (4182.0, 14168200),
                "2025-12-11": (4100.0, 14885000),
                "2025-12-12": (4181.0, 18320400),
                "2025-12-15": (4139.0, 7929100),
                "2025-12-16": (4071.0, 13090100),
                "2025-12-17": (4039.0, 13727600),
                "2025-12-18": (4056.0, 12877200),
                "2025-12-19": (3994.0, 20303000),
                "2025-12-22": (3960.0, 12472900),
                "2025-12-23": (4069.0, 10782500),
                "2025-12-24": (3990.0, 10050700),
                "2025-12-25": (4039.0, 3991100),
                "2025-12-26": (4045.0, 6004900),
                "2025-12-29": (4029.0, 7097100),
                "2025-12-30": (4024.0, 7459900),
                "2026-01-05": (4079.0, 13062000),
                "2026-01-06": (4111.0, 14134700),
                "2026-01-07": (3976.0, 24382400),
                "2026-01-08": (3930.0, 16921400),
                "2026-01-09": (3876.0, 20179800),
                "2026-01-13": (3835.0, 28446400),
                "2026-01-14": (3848.0, 23065400),
                "2026-01-15": (3904.0, 19963800),
                "2026-01-16": (3852.0, 18315800),
                "2026-01-19": (3780.0, 13754500),
                "2026-01-20": (3736.0, 13896800),
                "2026-01-21": (3701.0, 18278100),
                "2026-01-22": (3631.0, 18326300),
                "2026-01-23": (3614.0, 25770900),
                "2026-01-26": (3546.0, 20403200),
                "2026-01-27": (3490.0, 17298200),
                "2026-01-28": (3404.0, 20682800),
                "2026-01-29": (3432.0, 22968600),
                "2026-01-30": (3454.0, 18737100),
                "2026-02-02": (3409.0, 19623600),
            },
            "83060": {
                "2025-06-23": (1939.5, 34019700),
                "2025-06-24": (1972.0, 29758600),
                "2025-06-25": (1965.0, 27512900),
                "2025-06-26": (1976.5, 30161700),
                "2025-06-27": (1984.0, 55914400),
                "2025-06-30": (1983.0, 45138300),
                "2025-07-01": (1969.0, 37538500),
                "2025-07-02": (1973.5, 36491900),
                "2025-07-03": (1986.5, 27346100),
                "2025-07-04": (2015.5, 49668300),
                "2025-07-07": (1969.0, 43315200),
                "2025-07-08": (1967.0, 37110400),
                "2025-07-09": (1979.0, 27102200),
                "2025-07-10": (1972.5, 36128100),
                "2025-07-11": (2007.5, 61999500),
                "2025-07-14": (1992.5, 32652500),
                "2025-07-15": (1998.5, 36573700),
                "2025-07-16": (1970.0, 36454200),
                "2025-07-17": (1971.5, 24463800),
                "2025-07-18": (1968.0, 27493000),
                "2025-07-22": (2000.0, 36368500),
                "2025-07-23": (2097.5, 93269300),
                "2025-07-24": (2171.5, 69111100),
                "2025-07-25": (2157.0, 38320900),
                "2025-07-28": (2105.5, 39535800),
                "2025-07-29": (2071.5, 28810600),
                "2025-07-30": (2089.0, 23567400),
                "2025-07-31": (2110.5, 32029400),
                "2025-08-01": (2127.0, 43624900),
                "2025-08-04": (2047.0, 62389500),
                "2025-08-05": (2059.5, 44850300),
                "2025-08-06": (2077.5, 31012900),
                "2025-08-07": (2116.0, 38214000),
                "2025-08-08": (2129.5, 45279500),
                "2025-08-12": (2223.5, 88935600),
                "2025-08-13": (2224.0, 55468500),
                "2025-08-14": (2239.5, 54772200),
                "2025-08-15": (2374.0, 94870900),
                "2025-08-18": (2313.5, 53442600),
                "2025-08-19": (2252.5, 52086400),
                "2025-08-20": (2262.0, 36596800),
                "2025-08-21": (2254.5, 24823600),
                "2025-08-22": (2291.0, 30815700),
                "2025-08-25": (2288.5, 32120800),
                "2025-08-26": (2272.0, 33503900),
                "2025-08-27": (2249.5, 26618400),
                "2025-08-28": (2267.5, 26882400),
                "2025-08-29": (2259.0, 25541900),
                "2025-09-01": (2250.5, 27735200),
                "2025-09-02": (2272.0, 25311000),
                "2025-09-03": (2200.5, 50342200),
                "2025-09-04": (2247.5, 31065900),
                "2025-09-05": (2268.5, 34350300),
                "2025-09-08": (2285.5, 37394500),
                "2025-09-09": (2260.0, 36120900),
                "2025-09-10": (2324.0, 46644900),
                "2025-09-11": (2283.5, 37082200),
                "2025-09-12": (2289.0, 35844500),
                "2025-09-16": (2290.5, 26719700),
                "2025-09-17": (2279.5, 26076700),
                "2025-09-18": (2282.0, 24929300),
                "2025-09-19": (2341.5, 78267400),
                "2025-09-22": (2369.0, 43209500),
                "2025-09-24": (2361.5, 40358600),
                "2025-09-25": (2373.0, 46495600),
                "2025-09-26": (2394.5, 55120900),
                "2025-09-29": (2327.0, 45169400),
                "2025-09-30": (2394.0, 54766700),
                "2025-10-01": (2318.0, 54241900),
                "2025-10-02": (2273.5, 41692800),
                "2025-10-03": (2313.0, 31228900),
                "2025-10-06": (2316.0, 77496300),
                "2025-10-07": (2293.5, 42592800),
                "2025-10-08": (2345.5, 48121900),
                "2025-10-09": (2360.0, 34517300),
                "2025-10-10": (2285.0, 46565100),
                "2025-10-14": (2241.0, 42023500),
                "2025-10-15": (2291.0, 25457000),
                "2025-10-16": (2301.0, 29182800),
                "2025-10-17": (2232.5, 37741100),
                "2025-10-20": (2325.0, 51875600),
                "2025-10-21": (2307.5, 48586400),
                "2025-10-22": (2280.0, 34928900),
                "2025-10-23": (2261.5, 30349200),
                "2025-10-24": (2234.0, 44301600),
                "2025-10-27": (2273.0, 40823800),
                "2025-10-28": (2273.5, 32770100),
                "2025-10-29": (2280.5, 36995800),
                "2025-10-30": (2322.0, 55985500),
                "2025-10-31": (2330.0, 36432100),
                "2025-11-04": (2332.0, 38663200),
                "2025-11-05": (2294.0, 59683300),
                "2025-11-06": (2330.0, 36200800),
                "2025-11-07": (2314.5, 29925800),
                "2025-11-10": (2330.0, 27249200),
                "2025-11-11": (2321.5, 26998400),
                "2025-11-12": (2400.0, 52034100),
                "2025-11-13": (2450.0, 46970400),
                "2025-11-14": (2451.0, 47106100),
                "2025-11-17": (2426.5, 47421600),
                "2025-11-18": (2345.0, 47038000),
                "2025-11-19": (2340.0, 39660400),
                "2025-11-20": (2386.5, 40564800),
                "2025-11-21": (2385.0, 45799100),
                "2025-11-25": (2377.5, 39826000),
                "2025-11-26": (2447.0, 55272600),
                "2025-11-27": (2415.0, 44687300),
                "2025-11-28": (2423.5, 27307200),
                "2025-12-01": (2463.0, 56069700),
                "2025-12-02": (2523.5, 69184100),
                "2025-12-03": (2470.0, 42305600),
                "2025-12-04": (2515.0, 37772900),
                "2025-12-05": (2529.5, 44245400),
                "2025-12-08": (2498.5, 40711700),
                "2025-12-09": (2486.0, 34952000),
                "2025-12-10": (2468.0, 42944300),
                "2025-12-11": (2438.5, 30768100),
                "2025-12-12": (2499.0, 59922700),
                "2025-12-15": (2558.0, 46689500),
                "2025-12-16": (2477.0, 58571300),
                "2025-12-17": (2453.5, 46437700),
                "2025-12-18": (2429.0, 33803100),
                "2025-12-19": (2449.5, 53054900),
                "2025-12-22": (2495.0, 45345800),
                "2025-12-23": (2515.0, 32584600),
                "2025-12-24": (2481.0, 27185600),
                "2025-12-25": (2484.5, 12797100),
                "2025-12-26": (2485.5, 18440000),
                "2025-12-29": (2496.5, 41254600),
                "2025-12-30": (2493.0, 24209200),
                "2026-01-05": (2545.0, 48107000),
                "2026-01-06": (2625.0, 53516300),
                "2026-01-07": (2619.0, 48037400),
                "2026-01-08": (2604.0, 36985100),
                "2026-01-09": (2642.0, 52749500),
                "2026-01-13": (2782.0, 68055700),
                "2026-01-14": (2879.5, 61539800),
                "2026-01-15": (2964.0, 72532500),
                "2026-01-16": (2990.0, 59690800),
                "2026-01-19": (2953.0, 46016800),
                "2026-01-20": (2934.0, 38085700),
                "2026-01-21": (2831.5, 60186900),
                "2026-01-22": (2817.5, 41165400),
                "2026-01-23": (2835.5, 37452100),
                "2026-01-26": (2730.0, 52322600),
                "2026-01-27": (2771.5, 37732900),
                "2026-01-28": (2750.0, 30463300),
                "2026-01-29": (2776.5, 38157400),
                "2026-01-30": (2804.5, 37132200),
                "2026-02-02": (2744.0, 47757300),
            },
        }
        self.prices = {}
        self.last_rebal = None
        self.data_count = 0
        self.Debug("Asset Shield JP - Embedded Data Test")
    def OnData(self, d):
        date_str = str(self.Time.date())
        for ticker, hist in self.data.items():
            if date_str in hist:
                price, vol = hist[date_str]
                self.prices[ticker] = price
                self.data_count += 1
        if len(self.prices) == 3:
            if self.last_rebal is None or (self.Time - self.last_rebal).days >= 20:
                for ticker in self.prices:
                    sym = self.AddEquity(f"SPY", Resolution.Daily).Symbol
                    # Can't actually trade JP stocks, just track
                self.last_rebal = self.Time
                self.Debug(f"Prices: {self.prices}")
    def OnEndOfAlgorithm(self):
        self.Debug(f"Data points: {self.data_count}")
        self.Debug(f"Final prices: {self.prices}")
